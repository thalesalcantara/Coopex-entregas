<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Master | COOPEX</title>
    <style>
        body { background: linear-gradient(120deg, #003399 0%, #0a185f 100%); font-family: 'Segoe UI', Arial, sans-serif; color: #0a185f;}
        .container { max-width: 1200px; margin: 40px auto; background: #fff; border-radius: 18px; box-shadow: 0 8px 40px #00339928; padding: 32px;}
        h1, h2, h3 { color: #003399; margin-bottom: 1rem;}
        table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; background: #f8faff;}
        th, td { border: 1px solid #e6e6e6; padding: 10px 12px; text-align: left;}
        th { background: #e6f0ff;}
        tr:nth-child(even) { background: #f7fafd;}
        .btn-danger { background: #be2020; color: #fff; border: none; padding: 0.3rem 1.1rem; border-radius: 1rem; font-weight: 600; cursor: pointer;}
        .btn-danger:hover { background: #7b1212;}
        .btn-edit { background: #003399; color: #fff; border: none; padding: 0.3rem 1.1rem; border-radius: 1rem; font-weight: 600; margin-right: 6px; cursor: pointer;}
        .btn-edit:hover { background: #0a185f;}
        .actions { display: flex; gap: 8px;}
        ul { list-style: none; padding-left: 0;}
        ul li { margin-bottom: 5px;}
        form.inline { display: inline;}
        .success, .danger { padding: 0.5rem 1rem; border-radius: 8px; margin-bottom: 1rem;}
        .success { background: #e3ffe6; color: #197a3d;}
        .danger { background: #ffdede; color: #a31212;}
    </style>
</head>
<body>
<div class="container">
    <h1>Painel Master - COOPEX</h1>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="success">{{ messages[0] }}</div>
      {% endif %}
    {% endwith %}
    <h2>Admins</h2>
    <table>
        <thead>
            <tr>
                <th>Nome</th><th>Usuário</th><th>Intervalo</th><th>Ações</th>
            </tr>
        </thead>
        <tbody>
        {% for admin in admins %}
            <tr>
                <td>{{ admin.nome }}</td>
                <td>{{ admin.username }}</td>
                <td>
                    {% if admin.intervalo_inicio and admin.intervalo_fim %}
                        {{ dias_label[admin.intervalo_inicio] }} a {{ dias_label[admin.intervalo_fim] }}
                    {% else %}-{% endif %}
                </td>
                <td>
                    <form method="post" action="{{ url_for('excluir_admin', admin_id=admin.id) }}" class="inline"
                     onsubmit="return confirm('Deseja excluir este admin?');">
                        <button type="submit" class="btn-danger">Excluir</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <h2>Cooperados</h2>
    <table>
        <thead>
            <tr>
                <th>Nome</th><th>Usuário</th><th>Ações</th>
            </tr>
        </thead>
        <tbody>
        {% for c in cooperados %}
            <tr>
                <td>{{ c.nome }}</td>
                <td>{{ c.username }}</td>
                <td>
                    <a href="{{ url_for('editar_cooperado', cooperado_id=c.id) }}" class="btn-edit">Editar</a>
                    <form method="post" action="{{ url_for('excluir_cooperado', cooperado_id=c.id) }}" class="inline"
                     onsubmit="return confirm('Excluir este cooperado?');">
                        <button type="submit" class="btn-danger">Excluir</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <h2>Contratos (Tipos de Valor/Desconto)</h2>
    <form method="post" action="{{ url_for('cadastrar_tipo_lancamento') }}">
        <input type="text" name="nome" placeholder="Nome do tipo" required>
        <select name="tipo" required>
            <option value="valor">Valor</option>
            <option value="desconto">Desconto</option>
        </select>
        <button type="submit" class="btn-edit">Cadastrar</button>
    </form>
    <ul>
    {% for tipo in tipos %}
        <li>
            {{ tipo.nome }} ({{ tipo.tipo }})
            <form method="post" action="{{ url_for('excluir_tipo_lancamento', tipo_id=tipo.id) }}" class="inline"
             onsubmit="return confirm('Excluir este contrato?');">
                <button type="submit" class="btn-danger">Excluir</button>
            </form>
        </li>
    {% endfor %}
    </ul>
    <h2>Lançamentos (Valores e Descontos)</h2>
    <a href="{{ url_for('cadastro_valor') }}" class="btn-edit" style="margin-bottom:1.1rem;display:inline-block;">Novo Lançamento</a>
    <table>
        <thead>
            <tr>
                <th>Data</th><th>Turno</th><th>Cooperado</th>
                <th>Tipo</th><th>Contrato</th><th>Valor</th>
                <th>Lançado por</th><th>Ações</th>
            </tr>
        </thead>
        <tbody>
        {% for v in valores %}
            <tr>
                <td>{{ v.data.strftime('%d/%m/%Y') }}</td>
                <td>{{ v.turno }}</td>
                <td>{{ v.cooperado.nome }}</td>
                <td>{{ v.tipo }}</td>
                <td>{{ v.tipo_lancamento.nome if v.tipo_lancamento else '' }}</td>
                <td>R$ {{ "%.2f"|format(v.valor) }}</td>
                <td>{{ v.criador.nome if v.criador else '' }}</td>
                <td class="actions">
                    <a href="{{ url_for('editar_valor', valor_id=v.id) }}" class="btn-edit">Editar</a>
                    <form method="post" action="{{ url_for('excluir_valor', valor_id=v.id) }}" class="inline"
                      onsubmit="return confirm('Excluir este lançamento?');">
                        <button type="submit" class="btn-danger">Excluir</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
